# 02 객체지향 프로그래밍

Last Edited: Aug 05, 2019 12:45 PM

### 01. 영화 예매 시스템

- 영화 (제목, 상영시간, 가격 정보)
- 상영 (실제로 관객들이 영화를 관람) ← 예매 대상
- 할인
  - 할인 조건 (하나의 상영에 여러 개 가능)
    - 순서 조건 (상영 순번)
    - 기간 조건 (요일, 시작 시간, 종료 시간)
  - 할인 정책 (하나의 상영에 하나만)
    - 금액 할인
    - 비율 할인

### 02. 객체지향 프로그래밍을 향해

- 클래스가 아니라 *객체를 지향하는 것*

  1) 어떤 클래스가 필요한지를 고민하기 전에 어떤 객체가 필요한 지 고민할 것

  2) 객체를 독립적인 존재가 아니라 기능을 구현하기 위해 협력하는 공동체의 일원으로 봐야 함

- 도메인

  - 프로그램의 구조는 도메인의 구조와 유사한 구조여야 함

- 훌륭한 클래스를 설계하기 위한 핵심

  - 어떤 부분을 외부에 공개하고 어떤 부분을 감출지를 결정하는 것
  - 클래스의 내부와 외부 구분 → 경계의 명확성이 객체의 자율성을 보장 & 프로그래머에게 구현의 자유 제공

- 자율적인 객체

  1) 객체는 상태와 행동을 함께 가지는 복합적인 존재

  2) 객체는 스스로 판단하고 행동하는 자율적인 존재

  → 객체를 자율적인 존재로 만들기 위해 객체 내부에 대한 접근을 통제한다.

  → 캡슐화와 접근 제어를 통해서

  - 퍼블릭 인터페이스 (외부에서 접근 가능한 부분) + 구현 (내부에서만 접근 가능)
  - "인터페이스와 구현의 분리" 원칙

- 프로그래머의 자유

  - 클래스 작성자 / 클라이언트 프로그래머
  - 구현 은닉을 통해 클라이언트 프로그래머에게 필요한 부분만 공개하자
  - 구현 은닉은 클래스 작성자와 클라이언트 프로그래머, 둘 모두에게 유용한 개념
  - 변경될 가능성이 있는 세부 구현은 private으로 감춰 버리자

- 협력하는 객체들의 공동체

  - Money 클래스 같은 것
  - 의미를 좀 더 명시적이고 분명하게 표현할 수 있다면, 객체를 사용해서 해당 개념을 구현해라 (비록 하나의 인스턴스 변수만 포함하더라도 상관없다)

- 협력에 관한 짧은 이야기

  - 객체는 다른 객체의 인터페이스에 공개된 행동을 수행하도록 요청(request) = 메시지를 전송
  - 요청을 받은(메시지를 수신한) 객체는 자율적인 방법(적절한 메서드)에 따라 요청을 처리한 후 응답(response)

### 03. 할인 요금 구하기

- 세부적인 할인 정책이 무엇인지는 movie는 알 필요 없고, discountpolicy에게 메시지를 전송할 뿐이다.
- 상속, 다형성 & 추상화의 원리
- 요금 할인 (AmountDiscountPolicy) 와 비율 할인(PercentDiscountPolicy) 는 대부분 유사하고 할인 요금을 계산하는 부분만 차이
  - 두 클래스 사이의 공통 코드는 추상 클래스인 DiscountPolicy로 구현
  - 실제로 요금을 계산하는 부분은 자식 메소드에서 오버라이딩한 메소드에서 계산
    - TEMPLATE METHOD 패턴 : 부모 클래스에 기본적인 알고리즘의 흐름을 구현하고 중간에 필요한 부분을 자식 클래스에게 위임하는 디자인 패턴

### 04. 상속과 다형성

- 컴파일 시간 의존성과 실행 시간 의존성
  - 의존성 : 어떤 클래스가 다른 클래스에 접근할 수 있는 경로를 가짐 / 해당 클래스의 객체의 메서드 호출
  - 코드의 의존성과 실행 시점의 의존성은 다를 수 있다. ( → 유연한 설계 가능)
  - 단, 코드의 의존성과 실행 시점의 의존성이 다르면 다를수록 코드를 이해하기 어려워짐 (tradeoff!)
    - 유연성과 가독성 사이에서 늘 고민해야 한다
- 상속과 인터페이스
  - 인터페이스는 객체가 이해할 수 있는 메시지의 목록을 정의
  - 결과적으로 자식 클래스는 부모 클래스가 수신할 수 있는 모든 메시지를 수신 가능 → 협력 관점에서 동일하게 작동
    - 자식 클래스가 부모 클래스를 대신 : 업캐스팅
- 다형성
  - 동일한 메시지를 수신했을 때 객체의 타입에 따라 다르게 응답할 수 있는 능력
    - 다형적인 협력에 참여하는 객체들은 모두 같은 메시지를 이해할 수 있어야 함
  - 컴파일 시간 의존성과 실행 시간 의존성이 다를 수 있다는 사실을 기반으로
  - 구현 방법은 다양하지만 메시지에 응답하기 위해 실행될 메서드를 *실행 시점* 에 결정한다는 공통점
    - 지연 바인딩 or 동적 바인딩 (<> 초기 바인딩 or 정적 바인딩)

### 05. 추상화와 유연성

- DiscountPolicy : 모든 할인 정책들이 수신할 수 있는 calculateDiscountAmount 메시지 정의
- DiscountCondition : 모든 할인 조건들이 수신할 수 있는 isSatisfiedBy 메시지 정의
- 유연한 설계
  - 유연성이 필요한 곳에 추상화를 사용한다!
